<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Futuras Cientistas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css"
    />
  </head>
  <body class="bglogin font-sans flex items-center justify-center min-h-screen">
    <!-- Seção de Login -->
    <section id="loginSection" class="w-full max-w-lg">
      <div class="bg-white p-8 rounded-lg shadow-lg">
        <div class="flex justify-center">
          <img
            src="./images/logo.jpeg"
            alt="logo"
            class="max-h-64 mb-6 rounded-full shadow-lg"
          />
        </div>
        <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">
          Administração<br />Futuras Cientistas
        </h2>
        <form>
          <div class="mb-4">
            <label
              for="email"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Email:</label
            >
            <input
              type="email"
              id="email"
              name="email"
              placeholder="nome@example.com"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              required
            />
          </div>
          <div class="mb-6">
            <label
              for="password"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Senha:</label
            >
            <input
              type="password"
              id="password"
              name="password"
              placeholder="************"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
              required
            />
          </div>
          <div class="flex items-center justify-between">
            <button
              type="submit"
              class="w-full py-2 px-4 text-white corpadrao hover:bg-cyan-800 hover:scale-105 hover:shadow-xl font-bold rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out"
            >
              Entrar
            </button>
          </div>
        </form>
      </div>
    </section>

    <!-- Seção do Dashboard -->
    <div class="bg-white w-full min-h-screen">
      <section id="dashboardSection" class="hidden">
        <header
          class="corpadrao shadow-md p-4 flex items-center justify-between"
        >
          <div class="flex items-center">
            <img
              src="./images/logo.jpeg"
              alt="logo"
              class="mr-4 rounded-full shadow-lg h-16 w-16"
            />
            <h1 class="text-3xl font-bold text-white">Dashboard Cientistas</h1>
          </div>
          <button
            id="logoutButton"
            class="text-white font-bold py-2 px-6 rounded flex items-center gap-2 hover:text-gray-300"
          >
            <span>Sair</span>
            <i class="mdi mdi-logout text-2xl"></i>
          </button>
        </header>
        <main class="p-8">
          <div
            class="flex flex-col md:flex-row justify-between items-center gap-4 mb-6"
          >
            <div class="relative w-full md:w-1/2">
              <span
                class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"
              >
                <i class="mdi mdi-magnify text-2xl"></i>
              </span>
              <input
                type="text"
                id="searchBar"
                placeholder="Buscar cientista..."
                class="w-auto pl-14 pr-4 py-3 rounded-lg shadow-sm border border-gray-300 focus:outline-none focus:ring-2 focus:ring-cyan-500"
              />
            </div>
            <button
              id="addScientistButton"
              class="corpadrao hover:bg-cyan-800 font-bold py-3 px-4 rounded-full flex items-center justify-center gap-2 text-white w-full md:w-auto"
            >
              <span>Adicionar Cientista</span>
              <ion-icon name="person-add-outline" class="text-2xl"></ion-icon>
            </button>
          </div>
          <div
            id="scientistsList"
            class="space-y-5 corpadrao p-10 rounded-lg shadow-md"
          >
            <!-- Cards das cientistas serão inseridos aqui -->
          </div>
        </main>
      </section>
    </div>

    <!-- Modal para Adicionar/Editar Cientista -->
    <div id="scientistModal" class="modal-overlay hidden">
      <div class="modal-content">
        <h3 id="modalTitle" class="text-2xl font-bold mb-4"></h3>
        {/* Adiciona enctype para permitir upload de ficheiro */}
        <form id="scientistForm" enctype="multipart/form-data">
          <input type="hidden" id="scientistId" />
          {/* Input hidden para guardar o caminho do ícone atual ao editar */}
          <input type="hidden" id="currentIconPath" />
          <div class="mb-4">
            <label for="nome" class="block text-gray-700">Nome</label>
            <input type="text" id="nome" class="modal-input" required />
        </div>
          {/* ***** ALTERAÇÃO: Input de URL para Input de Ficheiro ***** */}
          <div class="mb-4">
            <label for="icone_file" class="block text-gray-700">Ícone (Imagem)</label>
            <input 
              type="file" 
              id="icone_file" 
              name="icone_file" 
              class="modal-input file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100" 
              accept="image/png, image/jpeg, image/webp"
            />
            <p class="text-sm text-gray-500 mt-1">Deixe em branco se não quiser alterar o ícone existente (ao editar).</p>
            {/* Elemento para pré-visualização da imagem */}
            <img id="icone_preview" src="" alt="Pré-visualização do Ícone" class="mt-2 h-20 w-20 object-cover rounded hidden border border-gray-300">
          </div>
          <div class="mb-4">
            <label for="descricao" class="block text-gray-700">Descrição</label>
            <textarea
              id="descricao"
              class="modal-input"
              rows="3"
              required
            ></textarea>
          </div>
          <div class="mb-4">
            <label for="video_url" class="block text-gray-700"
              >URL do Vídeo</label
            >
            <input type="url" id="video_url" class="modal-input" required />
          </div>
          <div class="flex justify-end space-x-4">
            <button
              type="button"
              id="closeModalButton"
              class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"
            >
              Cancelar
            </button>
            <button
              type="submit"
              class="corpadrao hover:bg-cyan-800 text-white font-bold py-2 px-4 rounded"
            >
              Salvar
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal para Gerenciar Quiz -->
    <div id="quizModal" class="modal-overlay hidden">
      <div class="modal-content large">
        <button id="quizModalTitle"></button>

        <div class="mb-6">
          <h4 class="text-xl font-semibold mb-2">Perguntas Existentes</h4>
          <div
            id="quizQuestionsList"
            class="space-y-3 max-h-64 overflow-y-auto p-2 border rounded"
          >
            <!-- Perguntas serão inseridas aqui -->
          </div>
        </div>

        <hr class="my-6" />

        <h4 id="quizFormTitle" class="text-xl font-semibold mb-4">
          Adicionar Nova Pergunta
        </h4>
        <form id="quizForm">
          <input type="hidden" id="quizScientistId" />
          <input type="hidden" id="editingQuestionId" />
          <div class="mb-4">
            <label for="texto_pergunta" class="block text-gray-700"
              >Texto da Pergunta</label
            >
            <input
              type="text"
              id="texto_pergunta"
              class="modal-input"
              required
            />
          </div>

          <p class="text-sm text-gray-600 mb-2">
            Preencha as quatro opções e use o botão circular para marcar qual
            delas é a resposta correta.
          </p>

          <div
            id="quizOptionsContainer"
            class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"
          >
            <!-- As 4 opções de input serão geradas dinamicamente pelo script.js -->
          </div>

          <div class="flex justify-end space-x-4">
            <button
              type="button"
              id="closeQuizModalButton"
              class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"
            >
              Fechar
            </button>
            <button
              type="submit"
              id="quizSubmitButton"
              class="corpadrao hover:bg-cyan-800 text-white font-bold py-2 px-4 rounded"
            >
              Adicionar Pergunta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Indicador de Carregamento -->
    <div id="loadingIndicator" class="loading-overlay hidden">
      <div class="loader"></div>
    </div>

    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="script.js"></script>
  </body>
</html>
